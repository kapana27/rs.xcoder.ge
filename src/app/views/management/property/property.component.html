<p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>

<div class="actionButton">
  <div class="buttonBox">
    <p-tabMenu [model]="items" [activeItem]="items[0]" ></p-tabMenu>
  </div>
  <div class="buttonBox">
    <button (click)="personDialog()" *ngIf="distributed" pButton type="button" label="განპიროვნება" class="ui-button-danger"></button>&nbsp;&nbsp;
    <button (click)="showDialog()"  pButton type="button" label="ინვ. შებრუნება" class="ui-button-raised" *ngIf="inOut ==='out'"></button> &nbsp;&nbsp;
    <button (click)="showDialog1()"  pButton type="button" label="ინვ. საწყობში დაბრუნება" class="ui-button-raised" *ngIf="inOut ==='in'"></button> &nbsp;&nbsp;
    <!--button (click)="showDialog2()"  pButton type="button" label="ინვ. შებრუნება" class="ui-button-raised" *ngIf="inOut ==='in'"></button--> &nbsp;&nbsp;
    <button (click)="inventoryToBuildingDialog()" *ngIf="distributed" pButton type="button" label="ინვ. მოძრაობა შენობებს შორის" class="ui-button-raised"></button>&nbsp;&nbsp;
    <button  pButton icon="pi pi-search" label="ძებნა" class="ui-button-raised" (click)="inventorSearch()" *ngIf="searchBox !== true"></button>&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cart">
      <fa-icon [icon]="faCartPlus"  (click)="cartDialog()" size="2x"  ></fa-icon>
      {{this.cartItems.length}}
    </span>
  </div>
</div>

<div class="search" *ngIf="this.searchBox === true">
  <div class="row">
    <div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>დასახელება:</label>
      <input type="text"  pInputText placeholder="" [(ngModel)]="filter.name" />

    </div>
    <div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>მარკა:</label>
      <input type="text"  pInputText placeholder="" [(ngModel)]="filter.maker" />
    </div>
    <div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>მოდელი:</label>
      <div>
        <input type="text"  pInputText placeholder="" [(ngModel)]="filter.model" />
      </div>
    </div>

    <div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>განზ. ერთეული:</label>
      <div class="ui-inputgroup" >
        <p-dropdown [ngClass]="{ 'red':if_error(formErrors,'selectedMeasureUnitName')?'1px solid red': '' }" [autoWidth]="true" class="measureUnits" [options]="measureUnits"  placeholder="ერთეული" optionLabel="name" [(ngModel)]="newInventor.selectedMeasureUnitName"  [showClear]="true" ></p-dropdown>
      </div>
    </div>
    <div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>ჯგუფი:</label>
      <input type="text"  pInputText placeholder="" [(ngModel)]="filter.itemGroup" />

    </div>

    <div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>ერთეული:</label>
      <input type="text"  pInputText placeholder="" [(ngModel)]="filter.measureUnit" />
    </div>
    <!--div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>შტრიხ კოდი:</label>
      <div>
        <p-autoComplete  field="name" [size]="30" placeholder="შტრიხ კოდი" [minLength]="1"></p-autoComplete>
      </div>
    </div-->
    <div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>ტიპი:</label>
      <div>
        <input type="text"  pInputText placeholder="" [(ngModel)]="filter.itemType" />
      </div>
    </div>

    <div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>ქარხნული ნომერი:</label>
      <div>
        <input type="text"  pInputText placeholder="" [(ngModel)]="filter.factoryNumber" />

      </div>
    </div>
    <div class="col-m-12 col-lg-3" style="max-width: 200px">
      <label>მწარმოებელი:</label>
      <input type="text"  pInputText placeholder="" [(ngModel)]="filter.supplier" />
    </div>

    <div class="col-m-6 col-lg-6" style="max-width: 320px">
      <label>თარიღი: დან-მდე</label>

      <form class="form-inline row">

        <div class="form-group col-md-6" >
          <div class="input-group">
            <input class="form-control"  placeholder=""
                   name="dp" [(ngModel)]="filter.dateFrom" ngbDatepicker #d10="ngbDatepicker" [minDate]="{ year:1990, month: 01, day: 01}" [maxDate]="{ year:2050, month: 01, day: 01}">
            <div class="input-group-append">
              <button pButton class="btn btn-outline-secondary "  type="button" icon="pi pi-calendar" (click)="d10.toggle()" ></button>
            </div>
          </div>
        </div>
        <div class="form-group col-md-6">
          <div class="input-group">
            <input class="form-control"  placeholder=""
                   name="dp" [(ngModel)]="filter.dateTo" ngbDatepicker #d11="ngbDatepicker" [minDate]="{ year:1990, month: 01, day: 01}" [maxDate]="{ year:2050, month: 01, day: 01}">
            <div class="input-group-append">
              <button pButton class="btn btn-outline-secondary "  type="button" icon="pi pi-calendar" (click)="d11.toggle()" ></button>
            </div>
          </div>
        </div>
      </form>
    </div>
    <div class="col-m-12 col-lg-6" style="max-width: 280px">
      <label>ფასი: დან-მდე</label>
      <div>
        <p-spinner size="7" placeholder="დან" style="width: 150px" [(ngModel)]="filter.priceFrom"></p-spinner>
        <p-spinner size="7" placeholder="მდე" [(ngModel)]="filter.priceTo"></p-spinner>
      </div>
    </div>
    <div class="col-m-6 col-lg-6" style="width: 445px">
      <label>შტრიხკოდი: დან-მდე</label>
      <div style="display: flex">
        <div>
          <p-dropdown [ngClass]="{ 'red':if_error(formErrors,'selectedBarcode')?'1px solid red': '' }" [autoWidth]="true" [options]="barcodes"   placeholder="RS"  optionLabel="name" [(ngModel)]="newInventor.selectedBarcode"  [showClear]="true" (ngModelChange)="getLastCode()" ></p-dropdown>
        </div>
        <input type="text"  pInputText placeholder="დან" style="width: 120px;"  [(ngModel)]="filter.barcodeFrom">
        <input type="text"  pInputText placeholder="მდე" style="width: 120px;" [(ngModel)]="filter.barcodeTo" >
      </div>
    </div>

    <div  style="min-width:350px; max-width: 100%; padding-right: 20px; padding-top: 21px; flex: 1;">
      <div style="float: right">
        <button pButton icon="pi pi-search" label="ძებნა" class="ui-button-warning" (click)="filterGrid()"></button>
        <button  pButton type="button" label="გასუფთავება" icon="pi pi-times" class="ui-button-danger" style="margin-left: 10px" (click)="filter={}"></button> &nbsp;&nbsp;
        <button pButton type="button" label="დახურვა" class="ui-button-secondary" (click)="CloseInventorSearch()" style="float: right; margin-left: 20px;"></button>
      </div>
    </div>
  </div>

</div>

<div class="row" *ngIf="inOut ==='out'">
  <ag-grid-angular
    [ngStyle]="{width: '100%', height: 'calc(100vh - '+(searchBox? 400: 135)+'px)'}"
    #agGrid
    style="width: 100%;height: calc(100vh - 135px);"
    id="myGrid"
    class="ag-theme-balham"
    [columnDefs]="columnDefs"
    [floatingFilter]="true"
    [debug]="true"
    [rowClassRules]="getRowStyle"
    [defaultColDef]="defaultColDef"
    [rowSelection]="rowSelection"
    [rowDeselection]="true"
    [rowModelType]="rowModelType"
    [paginationPageSize]="paginationPageSize"
    [cacheOverflowSize]="cacheOverflowSize"
    [maxConcurrentDatasourceRequests]="maxConcurrentDatasourceRequests"
    [infiniteInitialRowCount]="infiniteInitialRowCount"
    [maxBlocksInCache]="maxBlocksInCache"
    [getRowNodeId]="getRowNodeId"
    [components]="components"
    [rowData]="rowData"
    [pivotPanelShow]="true"
    (gridReady)="onGridReady($event)"
    (cellClicked)="cart($event)"
    [gridOptions]="gridOptions"
    [getContextMenuItems]="getContextMenuItems"
    [frameworkComponents]="frameworkComponents"

  ></ag-grid-angular>
</div>
<div class="row" *ngIf="inOut ==='in'">
  <ag-grid-angular
    [ngStyle]="{width: '100%', height: 'calc(100vh - '+(searchBox? 400: 135)+'px)'}"
    #agGrid
    style="width: 100%;height: calc(100vh - 135px);"
    id="myGrid"
    class="ag-theme-balham"
    [columnDefs]="columnDefs1"
    [floatingFilter]="true"
    [debug]="true"
    [rowClassRules]="getRowStyle"
    [defaultColDef]="defaultColDef"
    [rowSelection]="rowSelection"
    [rowDeselection]="true"
    [rowModelType]="rowModelType"
    [paginationPageSize]="paginationPageSize"
    [cacheOverflowSize]="cacheOverflowSize"
    [maxConcurrentDatasourceRequests]="maxConcurrentDatasourceRequests"
    [infiniteInitialRowCount]="infiniteInitialRowCount"
    [maxBlocksInCache]="maxBlocksInCache"
    [getRowNodeId]="getRowNodeId"
    [components]="components"
    [rowData]="rowData"
    [pivotPanelShow]="true"
    (gridReady)="onGridReady($event)"
    (cellClicked)="cart($event)"
    [gridOptions]="gridOptions"
    [getContextMenuItems]="getContextMenuItems"
    [frameworkComponents]="frameworkComponents"

  ></ag-grid-angular>
</div>
<div class="row" *ngIf="inOut ==='v2'">
  <ag-grid-angular
    #agGrid
    style="width: 100%;height: calc(100vh - 135px);"
    id="myGrid"
    class="ag-theme-balham"
    [columnDefs]="columnDefs1"
    [floatingFilter]="true"
    [debug]="true"
    [rowClassRules]="getRowStyle"
    [defaultColDef]="defaultColDef"
    [rowSelection]="rowSelection"
    [rowDeselection]="true"
    [rowModelType]="rowModelType"
    [paginationPageSize]="paginationPageSize"
    [cacheOverflowSize]="cacheOverflowSize"
    [maxConcurrentDatasourceRequests]="maxConcurrentDatasourceRequests"
    [infiniteInitialRowCount]="infiniteInitialRowCount"
    [maxBlocksInCache]="maxBlocksInCache"
    [getRowNodeId]="getRowNodeId"
    [components]="components"
    [rowData]="rowData"
    [pivotPanelShow]="true"
    (gridReady)="onGridReady($event)"
    (cellClicked)="cart($event)"
    [gridOptions]="gridOptions"
    [getContextMenuItems]="getContextMenuItems"
  ></ag-grid-angular>
</div>
<p-dialog header="ინვენტარის საწყობში დაბრუნება" *ngIf="display" [(visible)]="display" [modal]="true" [responsive]="true" [style]="{width: '900px', minWidth: '200px'}" [minY]="500"
          [maximizable]="true" [draggable]="true" [baseZIndex]="10000">
  <div style="width: 100%;height: 500px;" *ngIf="inventorReturnModel.inventarReturnGenerator">
    <app-generator [transferToSection]="inventorReturnModel" name="ქონების მართვის გასავლის ელ. ზედდებული" ></app-generator>
  </div>
  <div style="width: 100%;height: 500px;" *ngIf="!inventorReturnModel.inventarReturnGenerator">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12 ui-md-8">
        <div class="ui-g-12 ui-md-6">
          <p>თარიღი</p>
          <!--p-calendar [minDate]="minDate" dateFormat="dd-mm-yy" [(ngModel)]="inventorReturnModel.date" [showIcon]="true" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"></p-calendar-->
          <form class="form-inline">
            <div class="form-group">
              <div class="input-group">
                <input class="form-control" [minDate]="minDate"  placeholder="yyyy-mm-dd" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"
                       name="dp" [(ngModel)]="inventorReturnModel.date" ngbDatepicker #d6="ngbDatepicker">
                <div class="input-group-append">
                  <button pButton class="btn btn-outline-secondary "  type="button" icon="pi pi-calendar" (click)="d6.toggle()" ></button>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="ui-g-12 ui-md-6">
          <p>სექცია</p>
          <p-dropdown [ngClass]="{ 'red':if_error(formErrors,'selectedSection')?'1px solid red': '' }" [options]="stockList" optionLabel="name" placeholder="აირჩიეთ სექცია" [(ngModel)]="inventorReturnModel.selectedSection"  (ngModelChange)="getTransferProperty()"  ></p-dropdown>
        </div>
        <div class="ui-g-12 ui-md-6">
          <p>საწყობის მართვა</p>
          <p-dropdown   [ngClass]="{ 'red':if_error(formErrors,'selectedProperty')?'1px solid red': '' }" [options]="propertyData" optionLabel="fullname" placeholder="საწყობის მართვა" [(ngModel)]="inventorReturnModel.selectedProperty" ></p-dropdown>
        </div>
        <div class="ui-g-12 ui-md-6">
          <p>ტრანსპორტ. პასხ. პირი:</p>
          <p-autoComplete [ngClass]="{ 'red':if_error(formErrors,'selectedCarrier')?'1px solid red': '' }"  [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorReturnModel.selectedCarrier"
                          [minLength]="1" placeholder=""  field="fname" [dropdown]="false">
            <ng-template let-brand pTemplate="item">
              <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                <div style="font-size:12px;">{{brand['position']}}</div>
              </div>
            </ng-template>
          </p-autoComplete>
        </div>
      </div>

      <div class="ui-g-12 ui-md-4">
        <p>კომენტარი</p>
        <textarea pInputTextarea placeholder="შენიშვნა" [(ngModel)]="inventorReturnModel.note" rows="5"></textarea>
      </div>
      <app-cart [data]="cartItemsData" (checker)="checker($event)"></app-cart>
    </div>
  </div>
  <p-footer>
    <app-cart-button (removeCartItem)="removeCartItem()"></app-cart-button>
    <button style="position: absolute; left: 230px" pButton type="button" icon="pi pi-file" label="დოკუმენტები ({{ uploadFiles.length}})" (click)="filesDialog=true"> </button>
    <span style="width: 20px; margin-right: 20px" *ngIf="inventorReturnModel.inventarReturnGenerator">
      ბოლო კოდი - {{lastCode}}
    </span>
    <button type="button" pButton icon="pi pi-check"  *ngIf="!inventorReturnModel.inventarReturnGenerator"(click)="generateInventarReturn()" label="ზედდებულის გენერაცია"></button>
    <button type="button" pButton icon="pi pi-check"  *ngIf="inventorReturnModel.inventarReturnGenerator" (click)="activateInventarReturn()" label="ზედდებულის გააქტიურება"></button>
    <button type="button" pButton icon="pi pi-close" (click)="display=false" label="დახურვა" class="ui-button-secondary"></button>
  </p-footer>
</p-dialog>
<p-dialog header="ინვენტარის საწყობში დაბრუნება" *ngIf="display1" [(visible)]="display1" [modal]="true" [responsive]="true" [style]="{width: '900px', minWidth: '200px'}" [minY]="500"
          [maximizable]="true" [draggable]="true" [baseZIndex]="10000">
  <div style="width: 100%;height: 500px;" *ngIf="inventorReturnModel.inventarReturnGenerator">
    <app-generator [transferToSection]="inventorReturnModel" name="თანამშრომლის გასავლის ელ. ზედდებული" ></app-generator>
  </div>
  <div style="width: 100%;height: 500px;" *ngIf="!inventorReturnModel.inventarReturnGenerator">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12 ui-md-8">
        <div class="ui-g-12 ui-md-6">
          <p>თარიღი</p>
          <!--p-calendar [minDate]="minDate" dateFormat="dd-mm-yy" [(ngModel)]="inventorReturnModel.date" [showIcon]="true" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"></p-calendar-->
          <form class="form-inline">
            <div class="form-group">
              <div class="input-group">
                <input class="form-control" [minDate]="minDate"  placeholder="yyyy-mm-dd" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"
                       name="dp" [(ngModel)]="inventorReturnModel.date" ngbDatepicker #d6="ngbDatepicker">
                <div class="input-group-append">
                  <button pButton class="btn btn-outline-secondary "  type="button" icon="pi pi-calendar" (click)="d6.toggle()" ></button>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="ui-g-12 ui-md-6">
          <p>სექცია</p>
          <p-dropdown [ngClass]="{ 'red':if_error(formErrors,'selectedSection')?'1px solid red': '' }" [options]="stockList" optionLabel="name" placeholder="აირჩიეთ სექცია" [(ngModel)]="inventorReturnModel.selectedSection"  (ngModelChange)="getTransferProperty()"  ></p-dropdown>
        </div>
        <div class="ui-g-12 ui-md-6">
          <p>საწყობის მართვა</p>
          <p-dropdown   [ngClass]="{ 'red':if_error(formErrors,'selectedProperty')?'1px solid red': '' }" [options]="propertyData" optionLabel="fullname" placeholder="საწყობის მართვა" [(ngModel)]="inventorReturnModel.selectedProperty" ></p-dropdown>
        </div>
        <div class="ui-g-12 ui-md-6">
          <p>ტრანსპორტ. პასხ. პირი:</p>
          <p-autoComplete [ngClass]="{ 'red':if_error(formErrors,'selectedCarrier')?'1px solid red': '' }"  [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorReturnModel.selectedCarrier"
                          [minLength]="1" placeholder=""  field="fname" [dropdown]="false">
            <ng-template let-brand pTemplate="item">
              <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                <div style="font-size:12px;">{{brand['position']}}</div>
              </div>
            </ng-template>
          </p-autoComplete>
        </div>
      </div>

      <div class="ui-g-12 ui-md-4">
        <p>კომენტარი</p>
        <textarea pInputTextarea placeholder="შენიშვნა" [(ngModel)]="inventorReturnModel.note" rows="5"></textarea>
      </div>
      <app-cart [data]="cartItemsData" (checker)="checker($event)"></app-cart>
    </div>
  </div>
  <p-footer>
    <app-cart-button (removeCartItem)="removeCartItem()"></app-cart-button>
    <button style="position: absolute; left: 230px" pButton type="button" icon="pi pi-file" label="დოკუმენტები ({{ uploadFiles.length}})" (click)="filesDialog=true"> </button>
    <span style="width: 20px; margin-right: 20px" *ngIf="inventorReturnModel.inventarReturnGenerator">
      ბოლო კოდი - {{lastCode}}
    </span>
    <button type="button" pButton icon="pi pi-check"  *ngIf="!inventorReturnModel.inventarReturnGenerator"(click)="generateInventarReturn1()" label="ზედდებულის გენერაცია"></button>
    <button type="button" pButton icon="pi pi-check"  *ngIf="inventorReturnModel.inventarReturnGenerator" (click)="activateInventarReturn1()" label="ზედდებულის გააქტიურება"></button>
    <button type="button" pButton icon="pi pi-close" (click)="display=false" label="დახურვა" class="ui-button-secondary"></button>
  </p-footer>
</p-dialog>


<p-dialog header="ინვენტარის გაცემა" *ngIf="inventoryToBuildingDialogShow" [(visible)]="inventoryToBuildingDialogShow" [modal]="true" [responsive]="true" [style]="{width: '900px', minWidth: '200px'}" [minY]="500"
          [maximizable]="true" [draggable]="true" [baseZIndex]="10000">
  <p-header>
  </p-header>
  <div style="width: 100%;height: 500px;" *ngIf="inventorTransfer.generator">
    <app-generator [transferToSection]="inventorTransfer" name="ქონების მართვის გასავლის ელ.ზედდებული" ></app-generator>
  </div>
  <div style="width: 100%;height: 500px;" *ngIf="!inventorTransfer.generator">
    <p-tabView (onChange)="onTabChange($event)" >
      <p-tabPanel header="შენობა" [selected]="true" >
        <div class="ui-g ui-fluid" >
          <div class="ui-g-12 ui-md-8">
            <div class="ui-g-12 ui-md-6">
              <p>თარიღი</p>
              <!--p-calendar [minDate]="minDate" dateFormat="dd-mm-yy" [(ngModel)]="inventorTransfer.date" [showIcon]="true" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"></p-calendar-->
              <form class="form-inline">
                <div class="form-group">
                  <div class="input-group">
                    <input class="form-control" [minDate]="minDate"  placeholder="yyyy-mm-dd" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"
                           name="dp" [(ngModel)]="inventorTransfer.date" ngbDatepicker #d="ngbDatepicker">
                    <div class="input-group-append">
                      <button pButton class="btn btn-outline-secondary "  type="button" icon="pi pi-calendar" (click)="d.toggle()" ></button>
                    </div>
                  </div>
                </div>
              </form>

            </div>

            <div class="ui-g-12 ui-md-6">
              <p>ქონების მართვა</p>
              <p-autoComplete [dropdown]="true"  [(ngModel)]="inventorTransfer.selectedProperty"  (completeMethod)="filterPropertyList($event)"  [suggestions]="propertyList" [ngClass]="{ 'red':if_error(formErrors,'selectedMaker')?'1px solid red': '' }" field="fname" type="marker"  [size]="30"
                              placeholder="" [minLength]="1" (ngModelChange)="onKeyUpProperty($event)" >
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>





            </div>

            <div class="ui-g-12 ui-md-6">
              <p>მომთხოვნი პიროვნება</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedPerson"
                              [minLength]="1" placeholder=""  field="fname" [dropdown]="false"  [ngClass]="{ 'red':if_error(formErrors,'selectedPerson')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>

            <div class="ui-g-12 ui-md-6">
              <p>ტრანსპორტ. პასხ. პირი:</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedCarrier"
                              [minLength]="1" placeholder=""  field="fname" [dropdown]="false" [ngClass]="{ 'red':if_error(formErrors,'selectedCarrier')?'1px solid red': '' }" >
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>
          </div>
          <div class="ui-g-12 ui-md-4">
            <p>კომენტარი</p>
            <textarea pInputTextarea placeholder="შენიშვნა" rows="5" [(ngModel)]="inventorTransfer.note" [ngClass]="{ 'red':if_error(formErrors,'note')?'1px solid red': '' }"></textarea>
          </div>
        </div>
      </p-tabPanel>
      <!--p-tabPanel header="პიროვნება" >
        <div class="ui-g ui-fluid" >
          <div class="ui-g-12 ui-md-8">
            <div class="ui-g-12 ui-md-6">
              <p>თარიღი</p>
              <form class="form-inline">
                <div class="form-group">
                  <div class="input-group">
                    <input class="form-control" [minDate]="minDate" placeholder="yyyy-mm-dd" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"
                           name="dp" [(ngModel)]="inventorTransfer.date" ngbDatepicker #d1="ngbDatepicker">
                    <div class="input-group-append">
                      <button pButton class="btn btn-outline-secondary "  type="button" icon="pi pi-calendar" (click)="d1.toggle()" ></button>
                    </div>
                  </div>
                </div>
              </form>
            </div>

            <div class="ui-g-12 ui-md-6">
              <p>პიროვნება</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedPerson"
                              (onSelect)="selectPerson($event)" [minLength]="1" placeholder=""  field="fname" [dropdown]="false" [ngClass]="{ 'red':if_error(formErrors,'selectedPerson')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
              <span>{{location}}</span>
            </div>
            <div class="ui-g-12 ui-md-6">
              <p>სექცია</p>
              <p-dropdown [disabled]="!inventorTransfer.selectedPerson" [options]="roomsList" optionLabel="name" placeholder="აირჩიეთ სექცია" [(ngModel)]="inventorTransfer.selectedSection" [ngClass]="{ 'red':if_error(formErrors,'selectedSection')?'1px solid red': '' }" ></p-dropdown>
            </div>
            <div class="ui-g-12 ui-md-6">
              <p>ტრანსპორტ. პასხ. პირი:</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedCarrier"
                              [minLength]="1" placeholder=""  field="fname" [dropdown]="false" [ngClass]="{ 'red':if_error(formErrors,'selectedCarrier')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>
            <div class="ui-g-12 ui-md-6">
              <p>კომენტარი</p>
              <textarea pInputTextarea placeholder="შენიშვნა" rows="1" [(ngModel)]="inventorTransfer.note"></textarea>
            </div>

          </div>
          <div class="ui-g-12 ui-md-4">
            <div class="ui-g-12 ui-md-12">
              <p>ქონების მართვა</p>
              <p-autoComplete [suggestions]="propertyList" (completeMethod)="filterPropertyList($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedProperty"
                              [minLength]="1" placeholder=""  field="fname" [dropdown]="true" [ngClass]="{ 'red':if_error(formErrors,'selectedProperty')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>
            <div class="ui-g-12 ui-md-12">
              <p>მომთხოვნი პიროვნება</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedRequestPerson"
                              [minLength]="1" placeholder=""  field="fname" [dropdown]="false" [ngClass]="{ 'red':if_error(formErrors,'selectedRequestPerson')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>

          </div>
        </div>
      </p-tabPanel-->
    </p-tabView>
    <app-cart [data]="cartItemsData" (checker)="checker($event)"></app-cart>
  </div>
  <p-footer>
    <button style="position: absolute; left: 230px" pButton type="button" icon="pi pi-file" label="დოკუმენტები ({{ uploadFiles.length}})" (click)="filesDialog=true"> </button>
    <app-cart-button (removeCartItem)="removeCartItem()"></app-cart-button>
    <span style="width: 20px; margin-right: 20px" *ngIf="inventorTransfer.generator">
      ბოლო კოდი - {{lastCode}}
    </span>
    <button type="button" pButton icon="pi pi-check"  *ngIf="!inventorTransfer.generator" (click)="generaTeInventorTransfer()" label="ზედდებულის გენერაცია"></button>
    <button type="button" pButton icon="pi pi-check"  *ngIf="inventorTransfer.generator"  (click)="activeInventorTransfer()" label="ზედდებულის გააქტიურება"></button>
    <button type="button" pButton icon="pi pi-close" (click)="inventoryToBuildingDialogShow=false" label="დახურვა" class="ui-button-secondary"></button>
  </p-footer>
</p-dialog>
<p-dialog header=" "
         *ngIf="cartDialogShow" [(visible)]="cartDialogShow" [modal]="true" [responsive]="true" [style]="{width: '850px', minWidth: '200px'}" [minY]="500" [maximizable]="true" [draggable]="true" [baseZIndex]="10000">
  <div style="width: 100%;height: 500px;">
    <app-cart-button (removeCartItem)="removeCartItem()"></app-cart-button>
    <app-cart style="position: relative; top:30px;"  [data]="cartItemsData" (removeCartItem)="removeCartItem()" ></app-cart>
  </div>
</p-dialog>
<p-dialog header="ინვენტარის საწყობში დაბრუნება" *ngIf="inventoryToBuildingDialogShow1" [(visible)]="inventoryToBuildingDialogShow1" [modal]="true" [responsive]="true" [style]="{width: '900px', minWidth: '200px'}" [minY]="500"
          [maximizable]="true" [draggable]="true" [baseZIndex]="10000">
  <div style="width: 100%;height: 500px;" *ngIf="inventorTransfer.generator">
    <app-generator [transferToSection]="inventorTransfer" name="ქონების მართვის გასავლის ელ. ზედდებული" ></app-generator>
  </div>
  <div style="width: 100%;height: 500px;" *ngIf="!inventorTransfer.generator">
    <p-tabView (onChange)="onTabChange($event)" >
      <p-tabPanel header=" " [selected]="true" >
        <div class="ui-g ui-fluid" >
          <div class="ui-g-12 ui-md-8">
            <div class="ui-g-12 ui-md-6">
              <p>თარიღი</p>
              <!--p-calendar [minDate]="minDate"  dateFormat="dd-mm-yy" [(ngModel)]="inventorTransfer.date" [showIcon]="true" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"></p-calendar-->
              <form class="form-inline">
                <div class="form-group">
                  <div class="input-group">
                    <input class="form-control" [minDate]="minDate"  placeholder="yyyy-mm-dd" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"
                           name="dp" [(ngModel)]="inventorTransfer.date" ngbDatepicker #d3="ngbDatepicker">
                    <div class="input-group-append">
                      <button pButton class="btn btn-outline-secondary "  type="button" icon="pi pi-calendar" (click)="d3.toggle()" ></button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div class="ui-g-12 ui-md-6">
              <p>ქონების მართვა</p>
              <p-autoComplete [suggestions]="propertyList" (completeMethod)="filterPropertyList($event)"[size]="30" [(ngModel)]="inventorTransfer.selectedProperty"
                              [minLength]="1" placeholder=""  field="fname" [dropdown]="true" [ngClass]="{ 'red':if_error(formErrors,'selectedProperty')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>
          </div>
        </div>
      </p-tabPanel>
      <!--p-tabPanel header="პიროვნება" >
        <div class="ui-g ui-fluid" >
          <div class="ui-g-12 ui-md-8">
            <div class="ui-g-12 ui-md-6">
              <p>თარიღი</p>
              <form class="form-inline">
                <div class="form-group">
                  <div class="input-group">
                    <input class="form-control" [minDate]="minDate"  placeholder="yyyy-mm-dd" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"
                           name="dp" [(ngModel)]="inventorTransfer.date" ngbDatepicker #d4="ngbDatepicker">
                    <div class="input-group-append">
                      <button pButton class="btn btn-outline-secondary "  type="button" icon="pi pi-calendar" (click)="d4.toggle()" ></button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div class="ui-g-12 ui-md-6">
              <p>პიროვნება</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedPerson"
                              (onSelect)="selectPerson($event)" [minLength]="1" placeholder=""  field="fname" [dropdown]="false" [ngClass]="{ 'red':if_error(formErrors,'selectedPerson')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>

            <div class="ui-g-12 ui-md-6">
              <p>მომთხოვნი პიროვნება</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedRequestPerson"
                              [minLength]="1" placeholder=""   field="fname" [dropdown]="false" [ngClass]="{ 'red':if_error(formErrors,'selectedRequestPerson')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>
            <div class="ui-g-12 ui-md-6">
              <p>ტრანსპორტ. პასხ. პირი:</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedCarrier"
                              [minLength]="1" placeholder=""  field="fname" [dropdown]="false" [ngClass]="{ 'red':if_error(formErrors,'selectedCarrier')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>
            <div class="ui-g-12 ui-md-4">
              <p>კომენტარი</p>
              <textarea pInputTextarea placeholder="შენიშვნა" rows="1" [(ngModel)]="inventorTransfer.note"></textarea>
            </div>
          </div>
          <div class="ui-g-12 ui-md-4">
            <div class="ui-g-12 ui-md-12">
              <p>ქონების მართვა</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="inventorTransfer.selectedProperty"
                              [minLength]="1" placeholder=""  field="fname" [dropdown]="true" [ngClass]="{ 'red':if_error(formErrors,'selectedProperty')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>
            <div class="ui-g-12 ui-md-12">
              <p>სექცია</p>
              <p-dropdown [disabled]="!inventorTransfer.selectedProperty" [options]="stockList" optionLabel="name" placeholder="აირჩიეთ სექცია" [(ngModel)]="inventorTransfer.selectedSection" [ngClass]="{ 'red':if_error(formErrors,'selectedSection')?'1px solid red': '' }" ></p-dropdown>
            </div>
          </div>
        </div>
      </p-tabPanel-->
    </p-tabView>
    <app-cart [data]="cartItemsData" (checker)="checker($event)"></app-cart>

  </div>
  <p-footer>
    <app-cart-button (removeCartItem)="removeCartItem()"></app-cart-button>
    <button style="position: absolute; left: 230px" pButton type="button" icon="pi pi-file" label="დოკუმენტები ({{ uploadFiles.length}})" (click)="filesDialog=true"> </button>
    <span style="width: 20px; margin-right: 20px" *ngIf="inventorTransfer.generator">
      ბოლო კოდი - {{lastCode}}
    </span>
    <button type="button" pButton icon="pi pi-check"  *ngIf="!inventorTransfer.generator" (click)="generaTeInventorTransfer1()" label="ზედდებულის გენერაცია"></button>
    <button type="button" pButton icon="pi pi-check"  *ngIf="inventorTransfer.generator"  (click)="activeInventorTransfer1()" label="ზედდებულის გააქტიურება"></button>
    <button type="button" pButton icon="pi pi-close" (click)="inventoryToBuildingDialogShow=false" label="დახურვა" class="ui-button-secondary"></button>
  </p-footer>
</p-dialog>
<p-dialog header="განპიროვნება" *ngIf="personDialogShow" [(visible)]="personDialogShow" [modal]="true" [responsive]="true" [style]="{width: '900px', minWidth: '200px'}" [minY]="500"
          [maximizable]="true" [draggable]="true" [baseZIndex]="10000">
  <div style="width: 100%;height: 500px;" *ngIf="forPerson.generator">
    <app-generator [transferToSection]="forPerson"  name="ქონების მართვის გასავლის ელ. ზედდებული"></app-generator>
  </div>
  <div style="width: 100%;height: 500px;" *ngIf="!forPerson.generator">

        <div class="ui-g ui-fluid" >
          <div class="ui-g-12 ui-md-8">
            <div class="ui-g-12 ui-md-6">
              <p>თარიღი</p>
              <!--p-calendar [minDate]="minDate" dateFormat="dd-mm-yy" [(ngModel)]="forPerson.date" [showIcon]="true" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"></p-calendar-->
              <form class="form-inline">
                <div class="form-group">
                  <div class="input-group">
                    <input class="form-control" [minDate]="minDate"  placeholder="yyyy-mm-dd" [ngClass]="{ 'red':if_error(formErrors,'date')?'1px solid red': '' }"
                           name="dp" [(ngModel)]="forPerson.date" ngbDatepicker #d5="ngbDatepicker">
                    <div class="input-group-append">
                      <button pButton class="btn btn-outline-secondary "  type="button" icon="pi pi-calendar" (click)="d5.toggle()" ></button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div class="ui-g-12 ui-md-6">
              <p>პიროვნება</p>
              <p-autoComplete [suggestions]="staffList" (completeMethod)="filterStaff($event)" [size]="30" [(ngModel)]="forPerson.selectedPerson"
                              (onSelect)="selectPerson($event)" [minLength]="1" placeholder="აირჩიეთ პიროვნება"  field="fname" [dropdown]="false" [ngClass]="{ 'red':if_error(formErrors,'selectedPerson')?'1px solid red': '' }">
                <ng-template let-brand pTemplate="item">
                  <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                    <div style="font-size:14px;font-weight: bold">{{brand['fname']}}</div>
                    <div style="font-size:12px;">{{brand['position']}}</div>
                  </div>
                </ng-template>
              </p-autoComplete>
              <span>{{location}}</span>
            </div>
            <div class="ui-g-12 ui-md-12">
              <p>აირჩიეთ ოთახი</p>
              <p-dropdown [disabled]="!forPerson.selectedPerson" [options]="roomsList" optionLabel="name" placeholder="აირჩიეთ ოთახი" [(ngModel)]="forPerson.selectedRoom" [ngClass]="{ 'red':if_error(formErrors,'selectedRoom')?'1px solid red': '' }" ></p-dropdown>
            </div>
          </div>

          <div class="ui-g-12 ui-md-4">
            <p>კომენტარი</p>
            <textarea pInputTextarea placeholder="შენიშვნა" rows="5" [(ngModel)]="forPerson.note"></textarea>
          </div>
          <app-cart [data]="cartItemsData" (checker)="checker($event)" ></app-cart>
        </div>
  </div>
  <p-footer>
    <app-cart-button (removeCartItem)="removeCartItem()"></app-cart-button>
    <button style="position: absolute; left: 230px" pButton type="button" icon="pi pi-file" label="დოკუმენტები ({{ uploadFiles.length}})" (click)="filesDialog=true"> </button>
    <span style="width: 20px; margin-right: 20px" *ngIf="forPerson.generator">
      ბოლო კოდი - {{lastCode}}
    </span>
    <button type="button" pButton icon="pi pi-check"  *ngIf="!forPerson.generator" (click)="generateForPersonInvoice()" label="ზედდებულის გენერაცია"></button>
    <button type="button" pButton icon="pi pi-check"  *ngIf="forPerson.generator"  (click)="activeForPersonTransferInvoice()" label="ზედდებულის გააქტიურება"></button>
    <button type="button" pButton icon="pi pi-close" (click)="personDialogShow=false" label="დახურვა" class="ui-button-secondary"></button>
  </p-footer>
</p-dialog>

<p-dialog header="დოკუმენტების მიმაგრება" *ngIf="filesDialog" [(visible)]="filesDialog" [modal]="true" [responsive]="true" [style]="{width: '700px', minWidth: '200px'}" [minY]="500" [maximizable]="true" [draggable]="true" [baseZIndex]="10000">
  <div style="width: 100%;min-height: 250px;">
    <app-file-uploader (onFiles)="uploadedFiles($event)" [files]="uploadFiles"></app-file-uploader>
  </div>
</p-dialog>
